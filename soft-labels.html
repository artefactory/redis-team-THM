<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Soft labels</title>
        <link rel="stylesheet" href="https://artefactory.github.io/redis-team-THM/theme/css/main.css" />
        <meta name="description" content="Creating soft labels for the users" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://artefactory.github.io/redis-team-THM/">Team THM</a></h1>
                <nav><ul>
                    <li class="active"><a href="https://artefactory.github.io/redis-team-THM/category/machine-learning.html">Machine Learning</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/mlops.html">MLOps</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/redisearch.html">RediSearch</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/team.html">Team</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/thm-cli.html">THM CLI</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/thm-indexing.html">THM Indexing</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="https://artefactory.github.io/redis-team-THM/soft-labels.html" rel="bookmark"
           title="Permalink to Soft labels">Soft labels</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-10-28T14:05:00+02:00">
                Published: Fri 28 October 2022
        </abbr>
		<br />
        <abbr class="modified" title="2022-10-28T14:05:00+02:00">
                Updated: Fri 28 October 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://artefactory.github.io/redis-team-THM/author/tom-darmon.html">Tom Darmon</a>
        </address>
<p>In <a href="https://artefactory.github.io/redis-team-THM/category/machine-learning.html">Machine Learning</a>.</p>
<p>tags: <a href="https://artefactory.github.io/redis-team-THM/tag/data-science.html">data science</a> <a href="https://artefactory.github.io/redis-team-THM/tag/categories.html">categories</a> <a href="https://artefactory.github.io/redis-team-THM/tag/huggingface.html">huggingface</a> <a href="https://artefactory.github.io/redis-team-THM/tag/transformers.html">transformers</a> </p>
</footer><!-- /.post-info -->      <p><em>Day 6  - When we decided to quantify the categories of every article between 0 and 1.</em></p>
<h2>Help users find the balance between categories</h2>
<p>Many research papers fall on the borderline between several categories. Let's suppose we are looking for a technical research paper in Computational Complexity using Machine Learning. We will probably find several papers with similar names that belong to both categories that interest us. But we are Machine Learning experts, we want the paper to talk mostly about Machine Learning.</p>
<p>How can we do this?</p>
<h2>Soft labels</h2>
<p>We decided to solve this issue by assigning a value between 0 and 1 for each category of every paper. It means that if you are using the <code>thm-cli</code> you will obtain a value that quantify each category.</p>
<p>Suppose you are a Machine Learning expert looking for research paper discussing Computational Complexity, we've found 2 interesting papers:</p>
<p>Paper 1</p>
<div class="highlight"><pre><span></span><code><span class="nv">@article</span><span class="err">{</span><span class="n">alexa21</span><span class="w"></span>
<span class="w">    </span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Alexandre d&#39;Aspremont, Damien Scieur and Adrien Taylor&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Acceleration Methods&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nf">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;2021&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;https://arxiv.org/pdf/2101.09545.pdf&quot;</span><span class="p">,</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</code></pre></div>

<p>Paper 2</p>
<div class="highlight"><pre><span></span><code><span class="nv">@article</span><span class="err">{</span><span class="n">tanm20</span><span class="w"></span>
<span class="w">    </span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Tan M. Nguyen, Richard G. Baraniuk, Andrea L. Bertozzi, Stanley J. Osher, Bao Wang&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;MomentumRNN: Integrating Momentum into Recurrent Neural Networks&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="nf">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;2020&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;https://arxiv.org/pdf/2006.06919.pdf&quot;</span><span class="p">,</span><span class="w"></span>
<span class="err">}</span><span class="w"></span>
</code></pre></div>

<p>Paper 1 is associated with the categories:</p>
<ul>
<li>Optimization and Control</li>
<li>Machine Learning</li>
<li>Numerical Analysis</li>
<li>Numerical Analysis</li>
</ul>
<p>While Paper 2 is categorized into:</p>
<ul>
<li>Optimization and Control</li>
<li>Machine Learning</li>
<li>Dynamical Systems</li>
</ul>
<p>Both papers belong to the overlapping categories, so we want to be able to assign a weight to each category in order to be able to make a more informed decision.</p>
<h2>How did we compute the score for the categories?</h2>
<p>In order to obtain a fuzzy representation of categories, we decided to use a pre-trained language model (<a href="https://huggingface.co/prajjwal1/bert-tiny">bert-tiny</a>) on a multi label text classification problem. It was quite easy, as every article is already tagged with the categories.</p>
<p>The dataset is quite big, but the number of categories is relatively small. Therefore, we decided to train the model on only one epoch to avoid overfitting. One epoch gives our model a balance between correctly classifying the articles to the category they belong to, but at the same the model didn't have time to learn the data by heart and produce a score close to 1.</p>
<p>After computing the scores for each category offline, we only need to add the static data to our Redis database and retrieve it to show it to the user.</p>
<h2>Possible improvements</h2>
<p>The main problem here is that if we train the model too long, we risk overfitting the data and the predictions are equal to 1 for the real categories and 0 for the false categories (which is useless). But if we train the model too little we will obtain a model with mostly false predictions as it will not have time to converge.</p>
<p>Currently stopping the training after only one epoch is experimental, we can probably define a more rigorous protocol to select the best training parameters to compute the soft labels.</p>
<h2>Next Steps</h2>
<p>In the next steps, we will have to integrate this approach to our solution. This will involve creating separate training and serving pipelines for our model.</p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://github.com/artefactory/redis-team-THM/">GitHub</a></li>
                            <li><a href="https://www.artefact.com">Artefact</a></li>
                            <li><a href="https://redis.io/docs/stack">Redis Ventures</a></li>
                        </ul>
                </div><!-- /.blogroll -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'G-H5TDMDHN41', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>