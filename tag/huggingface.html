<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="generator" content="Pelican" />
        <title>Team THM - huggingface</title>
        <link rel="stylesheet" href="https://artefactory.github.io/redis-team-THM/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="https://artefactory.github.io/redis-team-THM/">Team THM</a></h1>
                <nav><ul>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/machine-learning.html">Machine Learning</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/mlops.html">MLOps</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/redisearch.html">RediSearch</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/team.html">Team</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/thm-cli.html">THM CLI</a></li>
                    <li><a href="https://artefactory.github.io/redis-team-THM/category/thm-indexing.html">THM Indexing</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="https://artefactory.github.io/redis-team-THM/integrate-labels.html">Paper Classification Integration</a></h1>
<footer class="post-info">
        <abbr class="published" title="2022-11-03T17:49:00+01:00">
                Published: Thu 03 November 2022
        </abbr>
		<br />
        <abbr class="modified" title="2022-11-03T17:49:00+01:00">
                Updated: Thu 03 November 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://artefactory.github.io/redis-team-THM/author/tom-darmon.html">Tom Darmon</a>
                        <a class="url fn" href="https://artefactory.github.io/redis-team-THM/author/henrique-brito.html">Henrique Brito</a>
        </address>
<p>In <a href="https://artefactory.github.io/redis-team-THM/category/machine-learning.html">Machine Learning</a>.</p>
<p>tags: <a href="https://artefactory.github.io/redis-team-THM/tag/categories.html">categories</a> <a href="https://artefactory.github.io/redis-team-THM/tag/huggingface.html">huggingface</a> <a href="https://artefactory.github.io/redis-team-THM/tag/transformers.html">transformers</a> </p>
</footer><!-- /.post-info --><p><em>Day 10 - Integrating the soft labels model to the pipeline</em></p>
<h1>Industrializing the soft labels model</h1>
<p>We have created a classification model to quantify the categories of each item between 0 and 1. It is now important to industrialize our code by integrating this model and this code into our workflow.</p>
<p>The model we decided to use for the classification is <a href="https://huggingface.co/prajjwal1/bert-tiny"><code>bert-tiny</code></a> from the <a href="https://huggingface.co/models">huggingface hub</a>. Our goal is to make data retrieval fast, in order to avoid making predictions on the category every time a user sends a query. We decided to make the inference offline and leverage redis speed to serve the metadata to the user.</p>
<h1>The step of the workflow</h1>
<p>We decided to split our classification pipeline in 3 steps:</p>
<ul>
<li><code>training</code>: We train our model and store the resulting weights locally. As a next step it would be good to save the weights to a service such as <a href="https://wandb.ai/site?utm_source=google&amp;utm_medium=cpc&amp;utm_campaign=Conversions%3A+Marketing+Site+-+Non-Branded+-+Dynamic+Search&amp;utm_content=Baseline+-+1st+Ad&amp;gclid=CjwKCAiA9qKbBhAzEiwAS4yeDfKlvTSoj2at5CSOCEidthehh-Bv85cS5XDQnLTi98v38YCOdhEFTBoCEc0QAvD_BwE">W&amp;B</a> or <a href="https://cloud.google.com/artifact-registry">Artifact Registry</a>.</li>
<li><code>inference</code>: We use the weights of our trained model to do the inference on the dataset, this is the step where we obtain the soft labels between 0 and 1.</li>
<li><code>re-training</code>: This script <a href="https://github.com/artefactory/redis-team-THM/blob/main/scripts/retrain_model.sh"><code>scripts/retrain_model.sh</code></a>  retrains the model, it needs to be run if new papers are added to the dataset. As a next step, it would be good to create a <a href="https://cloud.google.com/functions">Cloud Function</a> in order to automate the retraining of our model if new data is detected.</li>
</ul>
<h1>Including the soft labels and the text encoding in redis</h1>
<p>We decided to have only one <a href="https://github.com/artefactory/redis-team-THM/blob/main/scripts/generate_index.py">entry point</a> to generate the meta data of every paper:</p>
<ul>
<li><code>generate_index.py</code>:<ul>
<li>run the encoding for the text of every paper</li>
<li>run the soft label inference pipeline</li>
<li>save the data in a pickle file</li>
</ul>
</li>
</ul>
<p>The final pickle file is then pushed to <code>redis</code> using <a href="https://github.com/artefactory/redis-team-THM/blob/main/scripts/load_data.py"><code>load_data.py</code></a>.</p>
<p>One challenge we faced when pushing the categories to Redis was to chose a format to store the predicted categories and there associated score. We decided to store them in a string. In order to store and retrieve the categories/values we had to <a href="scripts/helpers/category_parser.py">parse the string</a>.</p>
<p>As a next step it would be possible to chose a better <a href="https://redis.io/docs/data-types/tutorial/">redis data type</a> than strings.</p>
<h1>Final result</h1>
<p>If we are looking directly inside the redis database we can see our soft labels stored as a string:</p>
<div align="center">
    <img src="https://artefactory.github.io/redis-team-THM/images/soft_labels_redis.png" width=500>
</div>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="https://artefactory.github.io/redis-team-THM/integrate-answer.html" rel="bookmark"
                           title="Permalink to Question Answering Integration">Question Answering Integration</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-11-03T15:28:00+01:00">
                Published: Thu 03 November 2022
        </abbr>
		<br />
        <abbr class="modified" title="2022-11-03T15:28:00+01:00">
                Updated: Thu 03 November 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://artefactory.github.io/redis-team-THM/author/henrique-brito.html">Henrique Brito</a>
        </address>
<p>In <a href="https://artefactory.github.io/redis-team-THM/category/machine-learning.html">Machine Learning</a>.</p>
<p>tags: <a href="https://artefactory.github.io/redis-team-THM/tag/question-answering.html">question-answering</a> <a href="https://artefactory.github.io/redis-team-THM/tag/huggingface.html">huggingface</a> <a href="https://artefactory.github.io/redis-team-THM/tag/transformers.html">transformers</a> </p>
</footer><!-- /.post-info -->                <p>Integrating a question answering pipeline into our workflow</p>
                <a class="readmore" href="https://artefactory.github.io/redis-team-THM/integrate-answer.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://artefactory.github.io/redis-team-THM/find-answer.html" rel="bookmark"
                           title="Permalink to Day 8 -Answering user's questions">Day 8 -Answering user's questions</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-10-30T11:23:00+01:00">
                Published: Sun 30 October 2022
        </abbr>
		<br />
        <abbr class="modified" title="2022-10-30T11:56:00+01:00">
                Updated: Sun 30 October 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://artefactory.github.io/redis-team-THM/author/henrique-brito.html">Henrique Brito</a>
        </address>
<p>In <a href="https://artefactory.github.io/redis-team-THM/category/machine-learning.html">Machine Learning</a>.</p>
<p>tags: <a href="https://artefactory.github.io/redis-team-THM/tag/question-answering.html">question-answering</a> <a href="https://artefactory.github.io/redis-team-THM/tag/huggingface.html">huggingface</a> <a href="https://artefactory.github.io/redis-team-THM/tag/transformers.html">transformers</a> </p>
</footer><!-- /.post-info -->                <p>Our data science approach to answer users' questions</p>
                <a class="readmore" href="https://artefactory.github.io/redis-team-THM/find-answer.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="https://artefactory.github.io/redis-team-THM/soft-labels.html" rel="bookmark"
                           title="Permalink to Soft labels">Soft labels</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-10-28T14:05:00+02:00">
                Published: Fri 28 October 2022
        </abbr>
		<br />
        <abbr class="modified" title="2022-10-28T14:05:00+02:00">
                Updated: Fri 28 October 2022
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="https://artefactory.github.io/redis-team-THM/author/tom-darmon.html">Tom Darmon</a>
        </address>
<p>In <a href="https://artefactory.github.io/redis-team-THM/category/machine-learning.html">Machine Learning</a>.</p>
<p>tags: <a href="https://artefactory.github.io/redis-team-THM/tag/data-science.html">data science</a> <a href="https://artefactory.github.io/redis-team-THM/tag/categories.html">categories</a> <a href="https://artefactory.github.io/redis-team-THM/tag/huggingface.html">huggingface</a> <a href="https://artefactory.github.io/redis-team-THM/tag/transformers.html">transformers</a> </p>
</footer><!-- /.post-info -->                <p>Creating soft labels for the users</p>
                <a class="readmore" href="https://artefactory.github.io/redis-team-THM/soft-labels.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://github.com/artefactory/redis-team-THM/">GitHub</a></li>
                            <li><a href="https://www.artefact.com">Artefact</a></li>
                            <li><a href="https://redis.io/docs/stack">Redis Ventures</a></li>
                        </ul>
                </div><!-- /.blogroll -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a href="https://www.python.org/">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'G-H5TDMDHN41', 'auto');
    ga('send', 'pageview');
    </script>
</body>
</html>